replaced peek-ahead ptr with streaming
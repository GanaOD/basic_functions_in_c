at each state, including transitions, update machine? like an inner checkbox to tick? flag reset?